<!DOCTYPE html><html lang="en" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v5.16.4"><title>Astro Basics</title><style>body{margin:0;font-family:Inter,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,sans-serif;background-color:#f2f5f1;color:#0f2412}#container[data-astro-cid-mmc7otgs]{min-height:100vh;position:relative;overflow:hidden}#background[data-astro-cid-mmc7otgs]{position:fixed;inset:0;width:100%;height:100%;opacity:.15;object-fit:cover;z-index:-1}main[data-astro-cid-mmc7otgs]{min-height:100vh;display:flex;justify-content:center;align-items:center;padding:4rem 1rem}#hero[data-astro-cid-mmc7otgs]{max-width:520px;width:100%}form[data-astro-cid-mmc7otgs]{display:flex;flex-direction:column;gap:.75rem;background:#fff;border-radius:1.25rem;padding:2rem;box-shadow:0 20px 60px #03200f1f}label[data-astro-cid-mmc7otgs]{font-weight:600;color:#1a2e22}input[data-astro-cid-mmc7otgs]{border:1px solid #cad6c9;border-radius:.75rem;padding:.9rem 1rem;font-size:1rem;background:#f9fbf8}input[data-astro-cid-mmc7otgs]:focus{outline:2px solid #1f8a4d;background:#fff}#links[data-astro-cid-mmc7otgs]{display:flex;justify-content:flex-end}.button[data-astro-cid-mmc7otgs]{background:#1f8a4d;color:#fff;border:none;border-radius:999px;padding:.85rem 1.75rem;font-size:1rem;font-weight:600;cursor:pointer;transition:background .16s ease}.button[data-astro-cid-mmc7otgs]:disabled{opacity:.6;cursor:not-allowed}.button[data-astro-cid-mmc7otgs]:not(:disabled):hover{background:#17673a}#status[data-astro-cid-mmc7otgs]{font-weight:600}@media(max-width:600px){main[data-astro-cid-mmc7otgs]{padding:2rem 1.25rem}form[data-astro-cid-mmc7otgs]{padding:1.5rem}}html,body{margin:0;width:100%;height:100%}
</style></head> <body data-astro-cid-sckkx6r4>  <div id="container" data-astro-cid-mmc7otgs> <img id="background" src="(...args) => {
    if (!validateArgs(args)) {
      throw new AstroError({
        ...InvalidComponentArgs,
        message: InvalidComponentArgs.message(name)
      });
    }
    return cb(...args);
  }" alt="" loading="lazy" aria-hidden="true" data-astro-cid-mmc7otgs> <main data-astro-cid-mmc7otgs> <section id="hero" data-astro-cid-mmc7otgs> <h1 data-astro-cid-mmc7otgs>Register for Green Career Fair 2025</h1> <p data-astro-cid-mmc7otgs>Sign up with your university details to get access.</p> <form id="registerForm" class="box" method="post" action="#" aria-label="University registration form" data-astro-cid-mmc7otgs> <label for="name" data-astro-cid-mmc7otgs>Full name</label> <input id="name" name="name" type="text" placeholder="Jane Doe" required data-astro-cid-mmc7otgs> <label for="email" data-astro-cid-mmc7otgs>University email</label> <input id="email" name="email" type="email" placeholder="name@university.edu" required pattern=".+@.+..+" data-astro-cid-mmc7otgs> <label for="course" data-astro-cid-mmc7otgs>Course</label> <input id="course" name="course" type="text" placeholder="BSc Computer Science" required data-astro-cid-mmc7otgs> <label for="gradYear" data-astro-cid-mmc7otgs>Graduation year</label> <input id="gradYear" name="gradYear" type="number" min="2023" max="2100" step="1" placeholder="2026" required data-astro-cid-mmc7otgs> <div id="links" data-astro-cid-mmc7otgs> <button id="submitBtn" type="submit" class="button" aria-label="Register" data-astro-cid-mmc7otgs>Register</button> </div> <div id="status" role="status" aria-live="polite" style="margin-top:12px;" data-astro-cid-mmc7otgs></div> </form> </section> </main> <script type="module">
	// Redirect to dashboard on client if registrationId cookie is present
	if (typeof document !== 'undefined' && document.cookie.split('; ').some(c => c.trim().startsWith('registrationId='))) {
		window.location.href = '/dashboard';
	}

	const form = document.getElementById('registerForm');
	const statusEl = document.getElementById('status');
	const submitBtn = document.getElementById('submitBtn');

	form.addEventListener('submit', async (e) => {
		e.preventDefault();
		statusEl.textContent = '';
		submitBtn.disabled = true;

		const fd = new FormData(form);
		const payload = {
			name: fd.get('name')?.toString() || '',
			email: fd.get('email')?.toString() || '',
			course: fd.get('course')?.toString() || '',
			gradYear: fd.get('gradYear')?.toString() || '',
		};

		try {
			const res = await fetch('/api/register', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(payload),
			});

			if (res.ok) {

			
				// parse response and store auto id in localStorage if present
				const data = await res.json().catch(() => null);	console.log(data.data.id);
				const id = String(data.data?.id ?? data.id ?? data.ID ?? data._id);
						console.log('Storing registration ID in cookie:', id);
						const maxAge = 60 * 60 * 24 * 30; // 30 days
						document.cookie = `registrationId=${encodeURIComponent(id)}; path=/; max-age=${maxAge}; SameSite=Lax; Secure`;
				const email = String(data.data?.email ?? data.id ?? data.ID ?? data._id);
						console.log('Storing registration ID in cookie:', id);
					
						document.cookie = `email=${encodeURIComponent(email)}; path=/; max-age=${maxAge}; SameSite=Lax; Secure`;
			
				
			}

			if (!res.ok) {
				const err = await res.json().catch(() => ({ message: res.statusText }));
				statusEl.textContent = 'Registration failed: ' + (err.message || res.statusText);
				statusEl.style.color = 'crimson';
			} else {
				statusEl.textContent = 'Registration successful. Check your email for next steps.';
				statusEl.style.color = 'green';
				window.location.href = '/dashboard';
				form.reset();
			}
		} catch (error) {
			statusEl.textContent = 'Network error. Please try again.';
			statusEl.style.color = 'crimson';
		} finally {
			submitBtn.disabled = false;
		}
	});
</script>  </div>  </body></html>